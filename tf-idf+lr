tf-idf+
#读取数据
import pandas as pd
import numpy as np
from collections import Counter
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics import f1_score
from sklearn.metrics import accuracy_score
from xgboost import XGBClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.linear_model import RidgeClassifier

#导入数据
train_data=pd.read_csv('datalab/72510/train_set.csv',sep='\t',)
test_data=pd.read_csv('datalab/72510/test_a.csv',sep='\t',)
new_data=pd.concat([train_data['text'],test_data['text']])
#检查数据量
a=len(train_data)
b=len(test_data)
c=len(new_data)
print(a,b,c)
#td-idf
tfidf = TfidfVectorizer(ngram_range=(1,3), max_features=3000)
train_test = tfidf.fit_transform(train_data['text'])
clf = RidgeClassifier()
clf.fit(train_test[:10000], train_data['label'].values[:10000])
val_pred = clf.predict(train_test[10000:])
print(f1_score(train_df['label'].values[10000:], val_pred, average='macro'))
